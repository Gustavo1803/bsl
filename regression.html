<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Regression | Basics of Statistical Learning</title>
  <meta name="description" content="Chapter 9 Regression | Basics of Statistical Learning" />
  <meta name="generator" content="bookdown 0.14.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Regression | Basics of Statistical Learning" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://daviddalpiaz.github.io/bsl/" />
  
  
  <meta name="github-repo" content="daviddalpiaz/bsl" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Regression | Basics of Statistical Learning" />
  
  
  

<meta name="author" content="David Dalpiaz" />


<meta name="date" content="2019-10-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-2.html"/>
<link rel="next" href="biasvariance-tradeoff.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Basics of Statistical Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caveat-emptor"><i class="fa fa-check"></i>Caveat Emptor</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who"><i class="fa fa-check"></i>Who?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i>Organization</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="part"><span><b>I A Machine Learning Preview</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html"><i class="fa fa-check"></i><b>2</b> Regression: Powerlifting</a><ul>
<li class="chapter" data-level="2.1" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a></li>
<li class="chapter" data-level="2.2" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#data"><i class="fa fa-check"></i><b>2.2</b> Data</a></li>
<li class="chapter" data-level="2.3" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#eda"><i class="fa fa-check"></i><b>2.3</b> EDA</a></li>
<li class="chapter" data-level="2.4" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#modeling"><i class="fa fa-check"></i><b>2.4</b> Modeling</a></li>
<li class="chapter" data-level="2.5" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#model-evaluation"><i class="fa fa-check"></i><b>2.5</b> Model Evaluation</a></li>
<li class="chapter" data-level="2.6" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#discussion"><i class="fa fa-check"></i><b>2.6</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="classification-handwriting.html"><a href="classification-handwriting.html"><i class="fa fa-check"></i><b>3</b> Classification: Handwriting</a><ul>
<li class="chapter" data-level="3.1" data-path="classification-handwriting.html"><a href="classification-handwriting.html#background-1"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="classification-handwriting.html"><a href="classification-handwriting.html#data-1"><i class="fa fa-check"></i><b>3.2</b> Data</a></li>
<li class="chapter" data-level="3.3" data-path="classification-handwriting.html"><a href="classification-handwriting.html#eda-1"><i class="fa fa-check"></i><b>3.3</b> EDA</a></li>
<li class="chapter" data-level="3.4" data-path="classification-handwriting.html"><a href="classification-handwriting.html#modeling-1"><i class="fa fa-check"></i><b>3.4</b> Modeling</a></li>
<li class="chapter" data-level="3.5" data-path="classification-handwriting.html"><a href="classification-handwriting.html#model-evaluation-1"><i class="fa fa-check"></i><b>3.5</b> Model Evaluation</a></li>
<li class="chapter" data-level="3.6" data-path="classification-handwriting.html"><a href="classification-handwriting.html#discussion-1"><i class="fa fa-check"></i><b>3.6</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html"><i class="fa fa-check"></i><b>4</b> Clustering: Basketball Players</a><ul>
<li class="chapter" data-level="4.1" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#background-2"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#data-2"><i class="fa fa-check"></i><b>4.2</b> Data</a></li>
<li class="chapter" data-level="4.3" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#eda-2"><i class="fa fa-check"></i><b>4.3</b> EDA</a></li>
<li class="chapter" data-level="4.4" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#modeling-2"><i class="fa fa-check"></i><b>4.4</b> Modeling</a></li>
<li class="chapter" data-level="4.5" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#model-evaluation-2"><i class="fa fa-check"></i><b>4.5</b> Model Evaluation</a></li>
<li class="chapter" data-level="4.6" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#discussion-2"><i class="fa fa-check"></i><b>4.6</b> Discussion</a></li>
</ul></li>
<li class="part"><span><b>II Some Machine Learning Foundations</b></span></li>
<li class="chapter" data-level="5" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>5</b> Introduction</a></li>
<li class="chapter" data-level="6" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>6</b> Probability</a><ul>
<li class="chapter" data-level="6.1" data-path="probability.html"><a href="probability.html#probability-models"><i class="fa fa-check"></i><b>6.1</b> Probability Models</a></li>
<li class="chapter" data-level="6.2" data-path="probability.html"><a href="probability.html#probability-axioms"><i class="fa fa-check"></i><b>6.2</b> Probability Axioms</a></li>
<li class="chapter" data-level="6.3" data-path="probability.html"><a href="probability.html#probability-rules"><i class="fa fa-check"></i><b>6.3</b> Probability Rules</a></li>
<li class="chapter" data-level="6.4" data-path="probability.html"><a href="probability.html#random-variables"><i class="fa fa-check"></i><b>6.4</b> Random Variables</a><ul>
<li class="chapter" data-level="6.4.1" data-path="probability.html"><a href="probability.html#distributions"><i class="fa fa-check"></i><b>6.4.1</b> Distributions</a></li>
<li class="chapter" data-level="6.4.2" data-path="probability.html"><a href="probability.html#discrete-random-variables"><i class="fa fa-check"></i><b>6.4.2</b> Discrete Random Variables</a></li>
<li class="chapter" data-level="6.4.3" data-path="probability.html"><a href="probability.html#continuous-random-variables"><i class="fa fa-check"></i><b>6.4.3</b> Continuous Random Variables</a></li>
<li class="chapter" data-level="6.4.4" data-path="probability.html"><a href="probability.html#several-random-variables"><i class="fa fa-check"></i><b>6.4.4</b> Several Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="probability.html"><a href="probability.html#expectations"><i class="fa fa-check"></i><b>6.5</b> Expectations</a></li>
<li class="chapter" data-level="6.6" data-path="probability.html"><a href="probability.html#likelihood"><i class="fa fa-check"></i><b>6.6</b> Likelihood</a></li>
<li class="chapter" data-level="6.7" data-path="probability.html"><a href="probability.html#videos"><i class="fa fa-check"></i><b>6.7</b> Videos</a></li>
<li class="chapter" data-level="6.8" data-path="probability.html"><a href="probability.html#references"><i class="fa fa-check"></i><b>6.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>7</b> Estimation</a><ul>
<li class="chapter" data-level="7.1" data-path="estimation.html"><a href="estimation.html#probability-1"><i class="fa fa-check"></i><b>7.1</b> Probability</a></li>
<li class="chapter" data-level="7.2" data-path="estimation.html"><a href="estimation.html#statistics"><i class="fa fa-check"></i><b>7.2</b> Statistics</a></li>
<li class="chapter" data-level="7.3" data-path="estimation.html"><a href="estimation.html#estimators"><i class="fa fa-check"></i><b>7.3</b> Estimators</a><ul>
<li class="chapter" data-level="7.3.1" data-path="estimation.html"><a href="estimation.html#properties"><i class="fa fa-check"></i><b>7.3.1</b> Properties</a></li>
<li class="chapter" data-level="7.3.2" data-path="estimation.html"><a href="estimation.html#methods"><i class="fa fa-check"></i><b>7.3.2</b> Methods</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III A Tour of Machine Learning</b></span></li>
<li class="chapter" data-level="8" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i><b>8</b> Introduction</a></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#setup"><i class="fa fa-check"></i><b>9.1</b> Setup</a></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#modeling-3"><i class="fa fa-check"></i><b>9.2</b> Modeling</a><ul>
<li class="chapter" data-level="9.2.1" data-path="regression.html"><a href="regression.html#linear-models"><i class="fa fa-check"></i><b>9.2.1</b> Linear Models</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>9.2.2</b> k-Nearest Neighbors</a></li>
<li class="chapter" data-level="9.2.3" data-path="regression.html"><a href="regression.html#decision-trees"><i class="fa fa-check"></i><b>9.2.3</b> Decision Trees</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#procedure"><i class="fa fa-check"></i><b>9.3</b> Procedure</a></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#data-splitting"><i class="fa fa-check"></i><b>9.4</b> Data Splitting</a></li>
<li class="chapter" data-level="9.5" data-path="regression.html"><a href="regression.html#metrics"><i class="fa fa-check"></i><b>9.5</b> Metrics</a></li>
<li class="chapter" data-level="9.6" data-path="regression.html"><a href="regression.html#model-complexity"><i class="fa fa-check"></i><b>9.6</b> Model Complexity</a></li>
<li class="chapter" data-level="9.7" data-path="regression.html"><a href="regression.html#overfitting"><i class="fa fa-check"></i><b>9.7</b> Overfitting</a></li>
<li class="chapter" data-level="9.8" data-path="regression.html"><a href="regression.html#multiple-features"><i class="fa fa-check"></i><b>9.8</b> Multiple Features</a></li>
<li class="chapter" data-level="9.9" data-path="regression.html"><a href="regression.html#example-analysis"><i class="fa fa-check"></i><b>9.9</b> Example Analysis</a></li>
<li class="chapter" data-level="9.10" data-path="regression.html"><a href="regression.html#misc-todos"><i class="fa fa-check"></i><b>9.10</b> MISC TODOS</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html"><i class="fa fa-check"></i><b>10</b> Bias–Variance Tradeoff</a><ul>
<li class="chapter" data-level="10.1" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html#reducible-and-irreducible-error"><i class="fa fa-check"></i><b>10.1</b> Reducible and Irreducible Error</a></li>
<li class="chapter" data-level="10.2" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html#bias-variance-decomposition"><i class="fa fa-check"></i><b>10.2</b> Bias-Variance Decomposition</a></li>
<li class="chapter" data-level="10.3" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html#simulation"><i class="fa fa-check"></i><b>10.3</b> Simulation</a></li>
<li class="chapter" data-level="10.4" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html#estimating-expected-prediction-error"><i class="fa fa-check"></i><b>10.4</b> Estimating Expected Prediction Error</a></li>
<li class="chapter" data-level="10.5" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html#reproducibility"><i class="fa fa-check"></i><b>10.5</b> Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>11</b> Classification</a><ul>
<li class="chapter" data-level="11.1" data-path="classification.html"><a href="classification.html#stat-432-materials"><i class="fa fa-check"></i><b>11.1</b> STAT 432 Materials</a></li>
<li class="chapter" data-level="11.2" data-path="classification.html"><a href="classification.html#bayes-classifier"><i class="fa fa-check"></i><b>11.2</b> Bayes Classifier</a><ul>
<li class="chapter" data-level="11.2.1" data-path="classification.html"><a href="classification.html#bayes-error-rate"><i class="fa fa-check"></i><b>11.2.1</b> Bayes Error Rate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="classification.html"><a href="classification.html#building-a-classifier"><i class="fa fa-check"></i><b>11.3</b> Building a Classifier</a></li>
<li class="chapter" data-level="11.4" data-path="classification.html"><a href="classification.html#modeling-4"><i class="fa fa-check"></i><b>11.4</b> Modeling</a><ul>
<li class="chapter" data-level="11.4.1" data-path="classification.html"><a href="classification.html#linear-models-1"><i class="fa fa-check"></i><b>11.4.1</b> Linear Models</a></li>
<li class="chapter" data-level="11.4.2" data-path="classification.html"><a href="classification.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>11.4.2</b> k-Nearest Neighbors</a></li>
<li class="chapter" data-level="11.4.3" data-path="classification.html"><a href="classification.html#decision-trees-1"><i class="fa fa-check"></i><b>11.4.3</b> Decision Trees</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="classification.html"><a href="classification.html#misc-todo-stuff"><i class="fa fa-check"></i><b>11.5</b> MISC TODO STUFF</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="resampling.html"><a href="resampling.html"><i class="fa fa-check"></i><b>12</b> Resampling</a><ul>
<li class="chapter" data-level="12.1" data-path="resampling.html"><a href="resampling.html#stat-432-materials-1"><i class="fa fa-check"></i><b>12.1</b> STAT 432 Materials</a></li>
<li class="chapter" data-level="12.2" data-path="resampling.html"><a href="resampling.html#validation-set-approach"><i class="fa fa-check"></i><b>12.2</b> Validation-Set Approach</a></li>
<li class="chapter" data-level="12.3" data-path="resampling.html"><a href="resampling.html#cross-validation"><i class="fa fa-check"></i><b>12.3</b> Cross-Validation</a></li>
<li class="chapter" data-level="12.4" data-path="resampling.html"><a href="resampling.html#test-data"><i class="fa fa-check"></i><b>12.4</b> Test Data</a></li>
<li class="chapter" data-level="12.5" data-path="resampling.html"><a href="resampling.html#misc-todos-1"><i class="fa fa-check"></i><b>12.5</b> MISC TODOS</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>13</b> Supervised Learning</a></li>
<li class="chapter" data-level="14" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>14</b> Regularization</a><ul>
<li class="chapter" data-level="14.1" data-path="regularization.html"><a href="regularization.html#adding-bias-to-reduce-variance"><i class="fa fa-check"></i><b>14.1</b> adding bias to reduce variance</a></li>
<li class="chapter" data-level="14.2" data-path="regularization.html"><a href="regularization.html#scaling-matters"><i class="fa fa-check"></i><b>14.2</b> scaling matters?</a></li>
<li class="chapter" data-level="14.3" data-path="regularization.html"><a href="regularization.html#moving-to-two-dimensions"><i class="fa fa-check"></i><b>14.3</b> moving to two dimensions</a></li>
<li class="chapter" data-level="14.4" data-path="regularization.html"><a href="regularization.html#boston-is-boring"><i class="fa fa-check"></i><b>14.4</b> boston is boring</a></li>
<li class="chapter" data-level="14.5" data-path="regularization.html"><a href="regularization.html#some-more-simulation"><i class="fa fa-check"></i><b>14.5</b> some more simulation</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ensembles.html"><a href="ensembles.html"><i class="fa fa-check"></i><b>15</b> Ensembles</a><ul>
<li class="chapter" data-level="15.1" data-path="ensembles.html"><a href="ensembles.html#stat-432-materials-2"><i class="fa fa-check"></i><b>15.1</b> STAT 432 Materials</a></li>
</ul></li>
<li class="part"><span><b>IV Mathematics</b></span></li>
<li class="chapter" data-level="16" data-path="introduction-3.html"><a href="introduction-3.html"><i class="fa fa-check"></i><b>16</b> Introduction</a></li>
<li class="part"><span><b>V Computing</b></span></li>
<li class="chapter" data-level="17" data-path="introduction-4.html"><a href="introduction-4.html"><i class="fa fa-check"></i><b>17</b> Introduction</a></li>
<li class="chapter" data-level="18" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>18</b> Resources</a><ul>
<li class="chapter" data-level="18.1" data-path="resources.html"><a href="resources.html#resources-1"><i class="fa fa-check"></i><b>18.1</b> Resources</a><ul>
<li class="chapter" data-level="18.1.1" data-path="resources.html"><a href="resources.html#r"><i class="fa fa-check"></i><b>18.1.1</b> R</a></li>
<li class="chapter" data-level="18.1.2" data-path="resources.html"><a href="resources.html#rstudio"><i class="fa fa-check"></i><b>18.1.2</b> RStudio</a></li>
<li class="chapter" data-level="18.1.3" data-path="resources.html"><a href="resources.html#r-markdown"><i class="fa fa-check"></i><b>18.1.3</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="resources.html"><a href="resources.html#bsl-idioms"><i class="fa fa-check"></i><b>18.2</b> BSL Idioms</a><ul>
<li class="chapter" data-level="18.2.1" data-path="resources.html"><a href="resources.html#reference-style"><i class="fa fa-check"></i><b>18.2.1</b> Reference Style</a></li>
<li class="chapter" data-level="18.2.2" data-path="resources.html"><a href="resources.html#bsl-style-overrides"><i class="fa fa-check"></i><b>18.2.2</b> BSL Style Overrides</a></li>
<li class="chapter" data-level="18.2.3" data-path="resources.html"><a href="resources.html#objects-and-functions"><i class="fa fa-check"></i><b>18.2.3</b> Objects and Functions</a></li>
<li class="chapter" data-level="18.2.4" data-path="resources.html"><a href="resources.html#print-versus-return"><i class="fa fa-check"></i><b>18.2.4</b> Print versus Return</a></li>
<li class="chapter" data-level="18.2.5" data-path="resources.html"><a href="resources.html#help"><i class="fa fa-check"></i><b>18.2.5</b> Help</a></li>
<li class="chapter" data-level="18.2.6" data-path="resources.html"><a href="resources.html#keyboard-shortcuts"><i class="fa fa-check"></i><b>18.2.6</b> Keyboard Shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="resources.html"><a href="resources.html#common-issues"><i class="fa fa-check"></i><b>18.3</b> Common Issues</a></li>
</ul></li>
<li class="part"><span><b>VI Analysis</b></span></li>
<li class="chapter" data-level="19" data-path="introduction-5.html"><a href="introduction-5.html"><i class="fa fa-check"></i><b>19</b> Introduction</a></li>
<li class="part"><span><b>VII Appendix</b></span></li>
<li class="chapter" data-level="20" data-path="introduction-6.html"><a href="introduction-6.html"><i class="fa fa-check"></i><b>20</b> Introduction</a></li>
<li class="divider"></li>
<li><a href="https://github.com/daviddalpiaz/bsl" target="blank">&copy; 2019 David Dalpiaz</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Basics of Statistical Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Regression</h1>
<p><strong>BLUF</strong>:
Use <strong>regression</strong>, which is one of the two <strong>supervised learning</strong> tasks (the other being <strong>classification</strong>) to make predictions of new observations of <strong>numeric <em>response</em> variables.</strong>
Start by randomly splitting the data (which includes both the response and the <strong>features</strong>) into a <strong>test set</strong> and a <strong>training set</strong>.
Do not use the test data for anything other than supplying a final assesment of how well a chosen model performs at the prediction task.
That is, never use the test data to make <em>any</em> modeling decisions.
Use the training data however you please, but it is recommended to further split this data into an <strong>estimation set</strong> and a <strong>validation set</strong>.
The estimation set should be used to <strong>train</strong> models for evaluation. For example, use the estimation data to learn the <strong>model parameters</strong> of a <strong>parametric model</strong>.
Do not use data used in training of models (the estimation data) when evaluating models as doing so will mask <strong>overfitting</strong> of <strong>complex</strong> (flexible) models.
Use the <strong><code>lm()</code></strong> function to train <strong>linear models</strong>.
Use the <strong><code>knnreg()</code></strong> function from the <code>caret</code> pacakge to train <strong>k-nearest neighbors models</strong>.
Use the <strong><code>rpart()</code></strong> function from the <code>rpart</code> package to train <strong>decision tree models</strong>.
Use the validation set to evaluate models that have been trained using the estimation data. For example, use the validation data to select the value of <strong>tuning parameters</strong> that are often used in <strong>non-parametric models</strong>.
Use numeric metrics such as <strong>root-mean-square error (RMSE)</strong> or graphical summaries such as <strong>actual versus predicted plots</strong>.
Although it ignores some practical and statistical considerations (which will be discussed later), the model that acheives the lowest RMSE on the validation data will be deemed the “best” model. After finding this model, refit the model to the entire training dataset. Report the RMSE of this model on the test data as a final quantification of performance.</p>
<ul>
<li>TODO: add ISL readings</li>
<li>TODO: &lt;www.stat420.org&gt;</li>
<li>TODO: add “why least squares?” readings
<!-- - TODO: glossary of terms? -->
<!-- - TODO: pairs plot? -->
<!-- - TODO: check document in development folder --></li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="kw">library</span>(caret)</a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="kw">library</span>(rpart)</a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb50-5" data-line-number="5"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb50-6" data-line-number="6"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<div id="setup" class="section level2">
<h2><span class="header-section-number">9.1</span> Setup</h2>
<p><span class="math display">\[
Y = f(X) + \epsilon
\]</span></p>
<ul>
<li>TODO: signal <span class="math inline">\(f(X)\)</span></li>
<li>TODO: noise <span class="math inline">\(\epsilon\)</span></li>
<li>TODO: goal: learn the signal, not the noise</li>
<li>TODO: random variables versus potential realized values</li>
</ul>
<p><span class="math display">\[
X = (X_1, X_2, \ldots, X_p)
\]</span></p>
<p><span class="math display">\[
x = (x_1, x_2, \ldots, x_p)
\]</span></p>
<p><span class="math display">\[
\mathbb{E}\left[\left(Y - f(X)^2 \right)\right] = 
\]</span></p>
<ul>
<li>TODO: define regression function</li>
</ul>
<p><span class="math display">\[
f(x) = \mathbb{E}[Y \mid X = x]
\]</span></p>
<ul>
<li>TODO: want to learn these “things” which are regression functions</li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">line_reg_fun =<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb51-2" data-line-number="2">  x</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">}</a></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">quad_reg_fun =<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">  x <span class="op">^</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3">}</a></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">sine_reg_fun =<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb53-2" data-line-number="2">  <span class="kw">sin</span>(x)</a>
<a class="sourceLine" id="cb53-3" data-line-number="3">}</a></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">gen_sim_data =<span class="st"> </span><span class="cf">function</span>(f, <span class="dt">sample_size =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">  x =<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> sample_size, <span class="dt">min =</span> <span class="dv">-5</span>, <span class="dt">max =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb54-3" data-line-number="3">  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> sample_size, <span class="dt">mean =</span> <span class="kw">f</span>(x), <span class="dt">sd =</span> sd)</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">  tibble<span class="op">::</span><span class="kw">tibble</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)</a>
<a class="sourceLine" id="cb54-5" data-line-number="5">}</a></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb55-2" data-line-number="2">line_data =<span class="st"> </span><span class="kw">gen_sim_data</span>(<span class="dt">f =</span> line_reg_fun, <span class="dt">sample_size =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="fl">1.0</span>)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3">quad_data =<span class="st"> </span><span class="kw">gen_sim_data</span>(<span class="dt">f =</span> quad_reg_fun, <span class="dt">sample_size =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="fl">2.0</span>)</a>
<a class="sourceLine" id="cb55-4" data-line-number="4">sine_data =<span class="st"> </span><span class="kw">gen_sim_data</span>(<span class="dt">f =</span> sine_reg_fun, <span class="dt">sample_size =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb56-2" data-line-number="2">line_data_unseen =<span class="st"> </span><span class="kw">gen_sim_data</span>(<span class="dt">f =</span> line_reg_fun, <span class="dt">sample_size =</span> <span class="dv">100000</span>, <span class="dt">sd =</span> <span class="fl">1.0</span>)</a>
<a class="sourceLine" id="cb56-3" data-line-number="3">quad_data_unseen =<span class="st"> </span><span class="kw">gen_sim_data</span>(<span class="dt">f =</span> quad_reg_fun, <span class="dt">sample_size =</span> <span class="dv">100000</span>, <span class="dt">sd =</span> <span class="fl">2.0</span>)</a>
<a class="sourceLine" id="cb56-4" data-line-number="4">sine_data_unseen =<span class="st"> </span><span class="kw">gen_sim_data</span>(<span class="dt">f =</span> sine_reg_fun, <span class="dt">sample_size =</span> <span class="dv">100000</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="03-02-regression_files/figure-html/unnamed-chunk-10-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="modeling-3" class="section level2">
<h2><span class="header-section-number">9.2</span> Modeling</h2>
<ul>
<li>TODO: for now, only use formula syntax
<ul>
<li><a href="https://rviews.rstudio.com/2017/02/01/the-r-formula-method-the-good-parts/" class="uri">https://rviews.rstudio.com/2017/02/01/the-r-formula-method-the-good-parts/</a></li>
<li><a href="https://rviews.rstudio.com/2017/03/01/the-r-formula-method-the-bad-parts/" class="uri">https://rviews.rstudio.com/2017/03/01/the-r-formula-method-the-bad-parts/</a></li>
</ul></li>
</ul>
<div id="linear-models" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Linear Models</h3>
<ul>
<li>TODO: assume form of mean relationship. linear combination</li>
<li>TODO: how to go from y = b0 + b1x1 + … + eps to <code>lm(y ~ stuff)</code></li>
<li>TODO: least squares, least squares is least squares (difference in assumptions)</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">lm_line_int =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,                    <span class="dt">data =</span> line_data)</a>
<a class="sourceLine" id="cb57-2" data-line-number="2">lm_line_slr =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dt">degree =</span> <span class="dv">1</span>),  <span class="dt">data =</span> line_data)</a>
<a class="sourceLine" id="cb57-3" data-line-number="3">lm_line_ply =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dt">degree =</span> <span class="dv">20</span>), <span class="dt">data =</span> line_data)</a></code></pre></div>
<p><img src="03-02-regression_files/figure-html/unnamed-chunk-13-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="k-nearest-neighbors" class="section level3">
<h3><span class="header-section-number">9.2.2</span> k-Nearest Neighbors</h3>
<ul>
<li>TODO: <code>caret::knnreg()</code></li>
<li>TODO: for now, don’t worry about scaling, factors, etc.</li>
</ul>
<div id="linear-data" class="section level4">
<h4><span class="header-section-number">9.2.2.1</span> Linear Data</h4>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">knn_line_<span class="dv">25</span> =<span class="st"> </span><span class="kw">knnreg</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> line_data, <span class="dt">k =</span> <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb58-2" data-line-number="2">knn_line_<span class="dv">05</span> =<span class="st"> </span><span class="kw">knnreg</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> line_data, <span class="dt">k =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb58-3" data-line-number="3">knn_line_<span class="dv">01</span> =<span class="st"> </span><span class="kw">knnreg</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> line_data, <span class="dt">k =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="03-02-regression_files/figure-html/unnamed-chunk-15-1.png" width="1152" style="display: block; margin: auto;" /></p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
Train RMSE
</th>
<th style="text-align:right;">
Test RMSE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
1.406
</td>
<td style="text-align:right;">
1.379
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.931
</td>
<td style="text-align:right;">
1.061
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1.409
</td>
</tr>
</tbody>
</table>
</div>
<div id="quadratic-data" class="section level4">
<h4><span class="header-section-number">9.2.2.2</span> Quadratic Data</h4>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">knn_quad_<span class="dv">25</span> =<span class="st"> </span><span class="kw">knnreg</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> quad_data, <span class="dt">k =</span> <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb59-2" data-line-number="2">knn_quad_<span class="dv">05</span> =<span class="st"> </span><span class="kw">knnreg</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> quad_data, <span class="dt">k =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb59-3" data-line-number="3">knn_quad_<span class="dv">01</span> =<span class="st"> </span><span class="kw">knnreg</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> quad_data, <span class="dt">k =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="03-02-regression_files/figure-html/unnamed-chunk-18-1.png" width="1152" style="display: block; margin: auto;" /></p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
Train RMSE
</th>
<th style="text-align:right;">
Test RMSE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
6.393
</td>
<td style="text-align:right;">
6.564
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2.236
</td>
<td style="text-align:right;">
2.509
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
3.067
</td>
</tr>
</tbody>
</table>
</div>
<div id="sinusoidal-data" class="section level4">
<h4><span class="header-section-number">9.2.2.3</span> Sinusoidal Data</h4>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">knn_sine_<span class="dv">25</span> =<span class="st"> </span><span class="kw">knnreg</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sine_data, <span class="dt">k =</span> <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb60-2" data-line-number="2">knn_sine_<span class="dv">05</span> =<span class="st"> </span><span class="kw">knnreg</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sine_data, <span class="dt">k =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb60-3" data-line-number="3">knn_sine_<span class="dv">01</span> =<span class="st"> </span><span class="kw">knnreg</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sine_data, <span class="dt">k =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="03-02-regression_files/figure-html/unnamed-chunk-21-1.png" width="1152" style="display: block; margin: auto;" /></p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
Train RMSE
</th>
<th style="text-align:right;">
Test RMSE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0.814
</td>
<td style="text-align:right;">
0.841
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.349
</td>
<td style="text-align:right;">
0.570
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.647
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="decision-trees" class="section level3">
<h3><span class="header-section-number">9.2.3</span> Decision Trees</h3>
<ul>
<li>TODO: <code>rpart::rpart()</code></li>
<li>TODO: <a href="https://cran.r-project.org/web/packages/rpart/vignettes/longintro.pdf" class="uri">https://cran.r-project.org/web/packages/rpart/vignettes/longintro.pdf</a></li>
<li>TODO: <a href="http://www.milbo.org/doc/prp.pdf" class="uri">http://www.milbo.org/doc/prp.pdf</a></li>
<li>TODO: maybe notes about pruning and CV</li>
</ul>
<div id="linear-data-1" class="section level4">
<h4><span class="header-section-number">9.2.3.1</span> Linear Data</h4>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">tree_line_<span class="dv">010</span> =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> line_data, <span class="dt">cp =</span> <span class="fl">0.10</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2">tree_line_<span class="dv">001</span> =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> line_data, <span class="dt">cp =</span> <span class="fl">0.01</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb61-3" data-line-number="3">tree_line_<span class="dv">000</span> =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> line_data, <span class="dt">cp =</span> <span class="fl">0.00</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="03-02-regression_files/figure-html/unnamed-chunk-24-1.png" width="1152" style="display: block; margin: auto;" /></p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
Train RMSE
</th>
<th style="text-align:right;">
Test RMSE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
1.394
</td>
<td style="text-align:right;">
1.548
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.914
</td>
<td style="text-align:right;">
1.144
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1.409
</td>
</tr>
</tbody>
</table>
</div>
<div id="quadratic-data-1" class="section level4">
<h4><span class="header-section-number">9.2.3.2</span> Quadratic Data</h4>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">tree_quad_<span class="dv">010</span> =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> quad_data, <span class="dt">cp =</span> <span class="fl">0.10</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">tree_quad_<span class="dv">001</span> =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> quad_data, <span class="dt">cp =</span> <span class="fl">0.01</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb62-3" data-line-number="3">tree_quad_<span class="dv">000</span> =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> quad_data, <span class="dt">cp =</span> <span class="fl">0.00</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="03-02-regression_files/figure-html/unnamed-chunk-27-1.png" width="1152" style="display: block; margin: auto;" /></p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
Train RMSE
</th>
<th style="text-align:right;">
Test RMSE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
3.376
</td>
<td style="text-align:right;">
3.869
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1.692
</td>
<td style="text-align:right;">
2.621
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
3.067
</td>
</tr>
</tbody>
</table>
</div>
<div id="sinusoidal-data-1" class="section level4">
<h4><span class="header-section-number">9.2.3.3</span> Sinusoidal Data</h4>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">tree_sine_<span class="dv">010</span> =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sine_data, <span class="dt">cp =</span> <span class="fl">0.10</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-2" data-line-number="2">tree_sine_<span class="dv">001</span> =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sine_data, <span class="dt">cp =</span> <span class="fl">0.01</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-3" data-line-number="3">tree_sine_<span class="dv">000</span> =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sine_data, <span class="dt">cp =</span> <span class="fl">0.00</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="03-02-regression_files/figure-html/unnamed-chunk-30-1.png" width="1152" style="display: block; margin: auto;" /></p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
Train RMSE
</th>
<th style="text-align:right;">
Test RMSE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0.414
</td>
<td style="text-align:right;">
0.659
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.235
</td>
<td style="text-align:right;">
0.629
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.647
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="procedure" class="section level2">
<h2><span class="header-section-number">9.3</span> Procedure</h2>
<ul>
<li>TODO: Look at data</li>
<li>TODO: Pick candiate models</li>
<li>TODO: Tune / train models</li>
<li>TODO: Pick “best” model
<ul>
<li>based on validation RMSE (note the issues with this)</li>
</ul></li>
<li>TODO: Use best model / report test metrics</li>
</ul>
</div>
<div id="data-splitting" class="section level2">
<h2><span class="header-section-number">9.4</span> Data Splitting</h2>
<ul>
<li>TODO: want to generalize to unseen data</li>
<li><p>TODO: for now, all variables should either be numeric, or factor</p></li>
<li>TODO: Training (Train) Data</li>
<li>TODO: Testing (Test) Data</li>
<li>TODO: Estimation Data</li>
<li>TODO: Validation Data
<ul>
<li><a href="https://en.wikipedia.org/wiki/Infinite_monkey_theorem" class="uri">https://en.wikipedia.org/wiki/Infinite_monkey_theorem</a></li>
</ul></li>
</ul>
<p><span class="math display">\[
\mathcal{D} = \{ (x_i, y_i) \in \mathbb{R}^p \times \mathbb{R}, \ i = 1, 2, \ldots n \}
\]</span></p>
<p><span class="math display">\[
\mathcal{D} = \mathcal{D}_{\texttt{trn}} \cup \mathcal{D}_{\texttt{tst}}
\]</span></p>
<p><span class="math display">\[
\mathcal{D}_{\texttt{trn}} = \mathcal{D}_{\texttt{est}} \cup \mathcal{D}_{\texttt{val}}
\]</span></p>
</div>
<div id="metrics" class="section level2">
<h2><span class="header-section-number">9.5</span> Metrics</h2>
<ul>
<li>TODO: RMSE</li>
</ul>
<p><span class="math display">\[
\text{rmse}\left(\hat{f}_{\texttt{set}}, \mathcal{D}_{\texttt{set}} \right) = \sqrt{\frac{1}{n_{\texttt{set}}}\displaystyle\sum_{i \in {\texttt{set}}}^{}\left(y_i - \hat{f}_{\texttt{set}}({x}_i)\right)^2}
\]</span></p>
<p><span class="math display">\[
\text{RMSE}_{\texttt{trn}} = \text{rmse}\left(\hat{f}_{\texttt{est}}, \mathcal{D}_{\texttt{est}}\right) = \sqrt{\frac{1}{n_{\texttt{est}}}\displaystyle\sum_{i \in {\texttt{est}}}^{}\left(y_i - \hat{f}_{\texttt{est}}({x}_i)\right)^2}
\]</span></p>
<p><span class="math display">\[
\text{RMSE}_{\texttt{val}} = \text{rmse}\left(\hat{f}_{\texttt{est}}, \mathcal{D}_{\texttt{val}}\right) = \sqrt{\frac{1}{n_{\texttt{val}}}\displaystyle\sum_{i \in {\texttt{val}}}^{}\left(y_i - \hat{f}_{\texttt{est}}({x}_i)\right)^2}
\]</span></p>
<p><span class="math display">\[
\text{RMSE}_{\texttt{tst}} = \text{rmse}\left(\hat{f}_{\texttt{trn}}, \mathcal{D}_{\texttt{tst}}\right) = \sqrt{\frac{1}{n_{\texttt{tst}}}\displaystyle\sum_{i \in {\texttt{tst}}}^{}\left(y_i - \hat{f}_{\texttt{trn}}({x}_i)\right)^2}
\]</span></p>
<ul>
<li>TODO: MAE</li>
<li>TODO: MAPE
<ul>
<li><a href="https://en.wikipedia.org/wiki/Mean_absolute_percentage_error" class="uri">https://en.wikipedia.org/wiki/Mean_absolute_percentage_error</a></li>
<li>but probably don’t use</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">calc_rmse =<span class="st"> </span><span class="cf">function</span>(model, data, response) {</a>
<a class="sourceLine" id="cb64-2" data-line-number="2">  actual =<span class="st"> </span>data[[response]]</a>
<a class="sourceLine" id="cb64-3" data-line-number="3">  predicted =<span class="st"> </span><span class="kw">predict</span>(model, data)</a>
<a class="sourceLine" id="cb64-4" data-line-number="4">  <span class="kw">sqrt</span>(<span class="kw">mean</span>((actual <span class="op">-</span><span class="st"> </span>predicted) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb64-5" data-line-number="5">}</a></code></pre></div>
</div>
<div id="model-complexity" class="section level2">
<h2><span class="header-section-number">9.6</span> Model Complexity</h2>
<ul>
<li>TODO: what determines the complexity of the above models?
<ul>
<li>lm: terms, xforms, interactions</li>
<li>knn: k (also terms, xforms, interactions)</li>
<li>tree: cp (with rpart, also others that we’ll keep mostly hidden) (also terms, xforms, interactions)</li>
</ul></li>
</ul>
</div>
<div id="overfitting" class="section level2">
<h2><span class="header-section-number">9.7</span> Overfitting</h2>
<ul>
<li>TODO: too complex</li>
<li>TODO: usual picture with training and validation error</li>
<li>TODO: define for the purposes of this course</li>
</ul>
</div>
<div id="multiple-features" class="section level2">
<h2><span class="header-section-number">9.8</span> Multiple Features</h2>
<ul>
<li>TODO: more features = more complex</li>
<li>TODO: how do the three models add additional features?</li>
</ul>
</div>
<div id="example-analysis" class="section level2">
<h2><span class="header-section-number">9.9</span> Example Analysis</h2>
<ul>
<li><p>TODO: Diamonds analysis</p></li>
<li><p>TODO: model.matrix()</p></li>
</ul>
</div>
<div id="misc-todos" class="section level2">
<h2><span class="header-section-number">9.10</span> MISC TODOS</h2>
<ul>
<li>lex fridman with ian: dataset (represent), model, optimize
<ul>
<li><a href="https://www.youtube.com/watch?v=Z6rxFNMGdn0" class="uri">https://www.youtube.com/watch?v=Z6rxFNMGdn0</a></li>
</ul></li>
<li>want to minimize E[(y - y_hat)^2]</li>
<li>predict() creates estimate of E[Y|X] with supplied model</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="biasvariance-tradeoff.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/daviddalpiaz/bsl/edit/master/03-02-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bsl.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
