<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Regularization | Basics of Statistical Learning</title>
  <meta name="description" content="Chapter 14 Regularization | Basics of Statistical Learning" />
  <meta name="generator" content="bookdown 0.15.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Regularization | Basics of Statistical Learning" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://daviddalpiaz.github.io/bsl/" />
  
  
  <meta name="github-repo" content="daviddalpiaz/bsl" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Regularization | Basics of Statistical Learning" />
  
  
  

<meta name="author" content="David Dalpiaz" />


<meta name="date" content="2019-11-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="supervised-learning.html"/>
<link rel="next" href="ensembles.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Basics of Statistical Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caveat-emptor"><i class="fa fa-check"></i>Caveat Emptor</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who"><i class="fa fa-check"></i>Who?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i>Organization</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="part"><span><b>I A Machine Learning Preview</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html"><i class="fa fa-check"></i><b>2</b> Regression: Powerlifting</a><ul>
<li class="chapter" data-level="2.1" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a></li>
<li class="chapter" data-level="2.2" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#data"><i class="fa fa-check"></i><b>2.2</b> Data</a></li>
<li class="chapter" data-level="2.3" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#eda"><i class="fa fa-check"></i><b>2.3</b> EDA</a></li>
<li class="chapter" data-level="2.4" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#modeling"><i class="fa fa-check"></i><b>2.4</b> Modeling</a></li>
<li class="chapter" data-level="2.5" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#model-evaluation"><i class="fa fa-check"></i><b>2.5</b> Model Evaluation</a></li>
<li class="chapter" data-level="2.6" data-path="regression-powerlifting.html"><a href="regression-powerlifting.html#discussion"><i class="fa fa-check"></i><b>2.6</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="classification-handwriting.html"><a href="classification-handwriting.html"><i class="fa fa-check"></i><b>3</b> Classification: Handwriting</a><ul>
<li class="chapter" data-level="3.1" data-path="classification-handwriting.html"><a href="classification-handwriting.html#background-1"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="classification-handwriting.html"><a href="classification-handwriting.html#data-1"><i class="fa fa-check"></i><b>3.2</b> Data</a></li>
<li class="chapter" data-level="3.3" data-path="classification-handwriting.html"><a href="classification-handwriting.html#eda-1"><i class="fa fa-check"></i><b>3.3</b> EDA</a></li>
<li class="chapter" data-level="3.4" data-path="classification-handwriting.html"><a href="classification-handwriting.html#modeling-1"><i class="fa fa-check"></i><b>3.4</b> Modeling</a></li>
<li class="chapter" data-level="3.5" data-path="classification-handwriting.html"><a href="classification-handwriting.html#model-evaluation-1"><i class="fa fa-check"></i><b>3.5</b> Model Evaluation</a></li>
<li class="chapter" data-level="3.6" data-path="classification-handwriting.html"><a href="classification-handwriting.html#discussion-1"><i class="fa fa-check"></i><b>3.6</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html"><i class="fa fa-check"></i><b>4</b> Clustering: Basketball Players</a><ul>
<li class="chapter" data-level="4.1" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#background-2"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#data-2"><i class="fa fa-check"></i><b>4.2</b> Data</a></li>
<li class="chapter" data-level="4.3" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#eda-2"><i class="fa fa-check"></i><b>4.3</b> EDA</a></li>
<li class="chapter" data-level="4.4" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#modeling-2"><i class="fa fa-check"></i><b>4.4</b> Modeling</a></li>
<li class="chapter" data-level="4.5" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#model-evaluation-2"><i class="fa fa-check"></i><b>4.5</b> Model Evaluation</a></li>
<li class="chapter" data-level="4.6" data-path="clustering-basketball-players.html"><a href="clustering-basketball-players.html#discussion-2"><i class="fa fa-check"></i><b>4.6</b> Discussion</a></li>
</ul></li>
<li class="part"><span><b>II Some Machine Learning Foundations</b></span></li>
<li class="chapter" data-level="5" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>5</b> Introduction</a></li>
<li class="chapter" data-level="6" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>6</b> Probability</a><ul>
<li class="chapter" data-level="6.1" data-path="probability.html"><a href="probability.html#probability-models"><i class="fa fa-check"></i><b>6.1</b> Probability Models</a></li>
<li class="chapter" data-level="6.2" data-path="probability.html"><a href="probability.html#probability-axioms"><i class="fa fa-check"></i><b>6.2</b> Probability Axioms</a></li>
<li class="chapter" data-level="6.3" data-path="probability.html"><a href="probability.html#probability-rules"><i class="fa fa-check"></i><b>6.3</b> Probability Rules</a></li>
<li class="chapter" data-level="6.4" data-path="probability.html"><a href="probability.html#random-variables"><i class="fa fa-check"></i><b>6.4</b> Random Variables</a><ul>
<li class="chapter" data-level="6.4.1" data-path="probability.html"><a href="probability.html#distributions"><i class="fa fa-check"></i><b>6.4.1</b> Distributions</a></li>
<li class="chapter" data-level="6.4.2" data-path="probability.html"><a href="probability.html#discrete-random-variables"><i class="fa fa-check"></i><b>6.4.2</b> Discrete Random Variables</a></li>
<li class="chapter" data-level="6.4.3" data-path="probability.html"><a href="probability.html#continuous-random-variables"><i class="fa fa-check"></i><b>6.4.3</b> Continuous Random Variables</a></li>
<li class="chapter" data-level="6.4.4" data-path="probability.html"><a href="probability.html#several-random-variables"><i class="fa fa-check"></i><b>6.4.4</b> Several Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="probability.html"><a href="probability.html#expectations"><i class="fa fa-check"></i><b>6.5</b> Expectations</a></li>
<li class="chapter" data-level="6.6" data-path="probability.html"><a href="probability.html#likelihood"><i class="fa fa-check"></i><b>6.6</b> Likelihood</a></li>
<li class="chapter" data-level="6.7" data-path="probability.html"><a href="probability.html#videos"><i class="fa fa-check"></i><b>6.7</b> Videos</a></li>
<li class="chapter" data-level="6.8" data-path="probability.html"><a href="probability.html#references"><i class="fa fa-check"></i><b>6.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>7</b> Estimation</a><ul>
<li class="chapter" data-level="7.1" data-path="estimation.html"><a href="estimation.html#probability-1"><i class="fa fa-check"></i><b>7.1</b> Probability</a></li>
<li class="chapter" data-level="7.2" data-path="estimation.html"><a href="estimation.html#statistics"><i class="fa fa-check"></i><b>7.2</b> Statistics</a></li>
<li class="chapter" data-level="7.3" data-path="estimation.html"><a href="estimation.html#estimators"><i class="fa fa-check"></i><b>7.3</b> Estimators</a><ul>
<li class="chapter" data-level="7.3.1" data-path="estimation.html"><a href="estimation.html#properties"><i class="fa fa-check"></i><b>7.3.1</b> Properties</a></li>
<li class="chapter" data-level="7.3.2" data-path="estimation.html"><a href="estimation.html#methods"><i class="fa fa-check"></i><b>7.3.2</b> Methods</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III A Tour of Machine Learning</b></span></li>
<li class="chapter" data-level="8" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i><b>8</b> Introduction</a></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#setup"><i class="fa fa-check"></i><b>9.1</b> Setup</a></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#modeling-3"><i class="fa fa-check"></i><b>9.2</b> Modeling</a><ul>
<li class="chapter" data-level="9.2.1" data-path="regression.html"><a href="regression.html#linear-models"><i class="fa fa-check"></i><b>9.2.1</b> Linear Models</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>9.2.2</b> k-Nearest Neighbors</a></li>
<li class="chapter" data-level="9.2.3" data-path="regression.html"><a href="regression.html#decision-trees"><i class="fa fa-check"></i><b>9.2.3</b> Decision Trees</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#procedure"><i class="fa fa-check"></i><b>9.3</b> Procedure</a></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#data-splitting"><i class="fa fa-check"></i><b>9.4</b> Data Splitting</a></li>
<li class="chapter" data-level="9.5" data-path="regression.html"><a href="regression.html#metrics"><i class="fa fa-check"></i><b>9.5</b> Metrics</a></li>
<li class="chapter" data-level="9.6" data-path="regression.html"><a href="regression.html#model-complexity"><i class="fa fa-check"></i><b>9.6</b> Model Complexity</a></li>
<li class="chapter" data-level="9.7" data-path="regression.html"><a href="regression.html#overfitting"><i class="fa fa-check"></i><b>9.7</b> Overfitting</a></li>
<li class="chapter" data-level="9.8" data-path="regression.html"><a href="regression.html#multiple-features"><i class="fa fa-check"></i><b>9.8</b> Multiple Features</a></li>
<li class="chapter" data-level="9.9" data-path="regression.html"><a href="regression.html#example-analysis"><i class="fa fa-check"></i><b>9.9</b> Example Analysis</a></li>
<li class="chapter" data-level="9.10" data-path="regression.html"><a href="regression.html#misc-todos"><i class="fa fa-check"></i><b>9.10</b> MISC TODOS</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html"><i class="fa fa-check"></i><b>10</b> Bias–Variance Tradeoff</a><ul>
<li class="chapter" data-level="10.1" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html#reducible-and-irreducible-error"><i class="fa fa-check"></i><b>10.1</b> Reducible and Irreducible Error</a></li>
<li class="chapter" data-level="10.2" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html#bias-variance-decomposition"><i class="fa fa-check"></i><b>10.2</b> Bias-Variance Decomposition</a></li>
<li class="chapter" data-level="10.3" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html#simulation"><i class="fa fa-check"></i><b>10.3</b> Simulation</a></li>
<li class="chapter" data-level="10.4" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html#estimating-expected-prediction-error"><i class="fa fa-check"></i><b>10.4</b> Estimating Expected Prediction Error</a></li>
<li class="chapter" data-level="10.5" data-path="biasvariance-tradeoff.html"><a href="biasvariance-tradeoff.html#reproducibility"><i class="fa fa-check"></i><b>10.5</b> Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>11</b> Classification</a><ul>
<li class="chapter" data-level="11.1" data-path="classification.html"><a href="classification.html#stat-432-materials"><i class="fa fa-check"></i><b>11.1</b> STAT 432 Materials</a></li>
<li class="chapter" data-level="11.2" data-path="classification.html"><a href="classification.html#bayes-classifier"><i class="fa fa-check"></i><b>11.2</b> Bayes Classifier</a><ul>
<li class="chapter" data-level="11.2.1" data-path="classification.html"><a href="classification.html#bayes-error-rate"><i class="fa fa-check"></i><b>11.2.1</b> Bayes Error Rate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="classification.html"><a href="classification.html#building-a-classifier"><i class="fa fa-check"></i><b>11.3</b> Building a Classifier</a></li>
<li class="chapter" data-level="11.4" data-path="classification.html"><a href="classification.html#modeling-4"><i class="fa fa-check"></i><b>11.4</b> Modeling</a><ul>
<li class="chapter" data-level="11.4.1" data-path="classification.html"><a href="classification.html#linear-models-1"><i class="fa fa-check"></i><b>11.4.1</b> Linear Models</a></li>
<li class="chapter" data-level="11.4.2" data-path="classification.html"><a href="classification.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>11.4.2</b> k-Nearest Neighbors</a></li>
<li class="chapter" data-level="11.4.3" data-path="classification.html"><a href="classification.html#decision-trees-1"><i class="fa fa-check"></i><b>11.4.3</b> Decision Trees</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="classification.html"><a href="classification.html#misc-todo-stuff"><i class="fa fa-check"></i><b>11.5</b> MISC TODO STUFF</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="resampling.html"><a href="resampling.html"><i class="fa fa-check"></i><b>12</b> Resampling</a><ul>
<li class="chapter" data-level="12.1" data-path="resampling.html"><a href="resampling.html#stat-432-materials-1"><i class="fa fa-check"></i><b>12.1</b> STAT 432 Materials</a></li>
<li class="chapter" data-level="12.2" data-path="resampling.html"><a href="resampling.html#validation-set-approach"><i class="fa fa-check"></i><b>12.2</b> Validation-Set Approach</a></li>
<li class="chapter" data-level="12.3" data-path="resampling.html"><a href="resampling.html#cross-validation"><i class="fa fa-check"></i><b>12.3</b> Cross-Validation</a></li>
<li class="chapter" data-level="12.4" data-path="resampling.html"><a href="resampling.html#test-data"><i class="fa fa-check"></i><b>12.4</b> Test Data</a></li>
<li class="chapter" data-level="12.5" data-path="resampling.html"><a href="resampling.html#misc-todos-1"><i class="fa fa-check"></i><b>12.5</b> MISC TODOS</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>13</b> Supervised Learning</a></li>
<li class="chapter" data-level="14" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>14</b> Regularization</a><ul>
<li class="chapter" data-level="14.1" data-path="regularization.html"><a href="regularization.html#stat-432-materials-2"><i class="fa fa-check"></i><b>14.1</b> STAT 432 Materials</a></li>
<li class="chapter" data-level="14.2" data-path="regularization.html"><a href="regularization.html#reducing-variance-with-added-bias"><i class="fa fa-check"></i><b>14.2</b> Reducing Variance with Added Bias</a></li>
<li class="chapter" data-level="14.3" data-path="regularization.html"><a href="regularization.html#scaling-matters"><i class="fa fa-check"></i><b>14.3</b> scaling matters?</a></li>
<li class="chapter" data-level="14.4" data-path="regularization.html"><a href="regularization.html#constraints-in-two-dimensions"><i class="fa fa-check"></i><b>14.4</b> Constraints in Two Dimensions</a></li>
<li class="chapter" data-level="14.5" data-path="regularization.html"><a href="regularization.html#high-dimensional-data"><i class="fa fa-check"></i><b>14.5</b> High Dimensional Data</a></li>
<li class="chapter" data-level="14.6" data-path="regularization.html"><a href="regularization.html#ridge-regression"><i class="fa fa-check"></i><b>14.6</b> Ridge Regression</a></li>
<li class="chapter" data-level="14.7" data-path="regularization.html"><a href="regularization.html#lasso"><i class="fa fa-check"></i><b>14.7</b> Lasso</a></li>
<li class="chapter" data-level="14.8" data-path="regularization.html"><a href="regularization.html#boston-is-boring"><i class="fa fa-check"></i><b>14.8</b> boston is boring</a></li>
<li class="chapter" data-level="14.9" data-path="regularization.html"><a href="regularization.html#some-more-simulation"><i class="fa fa-check"></i><b>14.9</b> some more simulation</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ensembles.html"><a href="ensembles.html"><i class="fa fa-check"></i><b>15</b> Ensembles</a><ul>
<li class="chapter" data-level="15.1" data-path="ensembles.html"><a href="ensembles.html#stat-432-materials-3"><i class="fa fa-check"></i><b>15.1</b> STAT 432 Materials</a></li>
<li class="chapter" data-level="15.2" data-path="ensembles.html"><a href="ensembles.html#bagging"><i class="fa fa-check"></i><b>15.2</b> Bagging</a><ul>
<li class="chapter" data-level="15.2.1" data-path="ensembles.html"><a href="ensembles.html#simultation-study"><i class="fa fa-check"></i><b>15.2.1</b> Simultation Study</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ensembles.html"><a href="ensembles.html#random-forest"><i class="fa fa-check"></i><b>15.3</b> Random Forest</a></li>
<li class="chapter" data-level="15.4" data-path="ensembles.html"><a href="ensembles.html#boosting"><i class="fa fa-check"></i><b>15.4</b> Boosting</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="practical-issues.html"><a href="practical-issues.html"><i class="fa fa-check"></i><b>16</b> Practical Issues</a><ul>
<li class="chapter" data-level="16.1" data-path="practical-issues.html"><a href="practical-issues.html#stat-432-materials-4"><i class="fa fa-check"></i><b>16.1</b> STAT 432 Materials</a></li>
<li class="chapter" data-level="16.2" data-path="practical-issues.html"><a href="practical-issues.html#feature-scaling"><i class="fa fa-check"></i><b>16.2</b> Feature Scaling</a></li>
<li class="chapter" data-level="16.3" data-path="practical-issues.html"><a href="practical-issues.html#categorical-features"><i class="fa fa-check"></i><b>16.3</b> Categorical Features</a></li>
</ul></li>
<li class="part"><span><b>IV Mathematics</b></span></li>
<li class="chapter" data-level="17" data-path="introduction-3.html"><a href="introduction-3.html"><i class="fa fa-check"></i><b>17</b> Introduction</a></li>
<li class="part"><span><b>V Computing</b></span></li>
<li class="chapter" data-level="18" data-path="introduction-4.html"><a href="introduction-4.html"><i class="fa fa-check"></i><b>18</b> Introduction</a></li>
<li class="chapter" data-level="19" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>19</b> Resources</a><ul>
<li class="chapter" data-level="19.1" data-path="resources.html"><a href="resources.html#resources-1"><i class="fa fa-check"></i><b>19.1</b> Resources</a><ul>
<li class="chapter" data-level="19.1.1" data-path="resources.html"><a href="resources.html#r"><i class="fa fa-check"></i><b>19.1.1</b> R</a></li>
<li class="chapter" data-level="19.1.2" data-path="resources.html"><a href="resources.html#rstudio"><i class="fa fa-check"></i><b>19.1.2</b> RStudio</a></li>
<li class="chapter" data-level="19.1.3" data-path="resources.html"><a href="resources.html#r-markdown"><i class="fa fa-check"></i><b>19.1.3</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="resources.html"><a href="resources.html#bsl-idioms"><i class="fa fa-check"></i><b>19.2</b> BSL Idioms</a><ul>
<li class="chapter" data-level="19.2.1" data-path="resources.html"><a href="resources.html#reference-style"><i class="fa fa-check"></i><b>19.2.1</b> Reference Style</a></li>
<li class="chapter" data-level="19.2.2" data-path="resources.html"><a href="resources.html#bsl-style-overrides"><i class="fa fa-check"></i><b>19.2.2</b> BSL Style Overrides</a></li>
<li class="chapter" data-level="19.2.3" data-path="resources.html"><a href="resources.html#objects-and-functions"><i class="fa fa-check"></i><b>19.2.3</b> Objects and Functions</a></li>
<li class="chapter" data-level="19.2.4" data-path="resources.html"><a href="resources.html#print-versus-return"><i class="fa fa-check"></i><b>19.2.4</b> Print versus Return</a></li>
<li class="chapter" data-level="19.2.5" data-path="resources.html"><a href="resources.html#help"><i class="fa fa-check"></i><b>19.2.5</b> Help</a></li>
<li class="chapter" data-level="19.2.6" data-path="resources.html"><a href="resources.html#keyboard-shortcuts"><i class="fa fa-check"></i><b>19.2.6</b> Keyboard Shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="resources.html"><a href="resources.html#common-issues"><i class="fa fa-check"></i><b>19.3</b> Common Issues</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simulation-and-bootstrap.html"><a href="simulation-and-bootstrap.html"><i class="fa fa-check"></i><b>20</b> Simulation and Bootstrap</a><ul>
<li class="chapter" data-level="20.1" data-path="simulation-and-bootstrap.html"><a href="simulation-and-bootstrap.html#stat-432-materials-5"><i class="fa fa-check"></i><b>20.1</b> STAT 432 Materials</a></li>
<li class="chapter" data-level="20.2" data-path="simulation-and-bootstrap.html"><a href="simulation-and-bootstrap.html#misc-notes"><i class="fa fa-check"></i><b>20.2</b> Misc Notes</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>21</b> Data Manipulation</a><ul>
<li class="chapter" data-level="21.1" data-path="data-manipulation.html"><a href="data-manipulation.html#dplyr"><i class="fa fa-check"></i><b>21.1</b> <code>dplyr</code></a></li>
<li class="chapter" data-level="21.2" data-path="data-manipulation.html"><a href="data-manipulation.html#data.table"><i class="fa fa-check"></i><b>21.2</b> <code>data.table</code></a></li>
<li class="chapter" data-level="21.3" data-path="data-manipulation.html"><a href="data-manipulation.html#data-splitting-with-dplyranti_join"><i class="fa fa-check"></i><b>21.3</b> Data Splitting with <code>dplyr::anti_join</code></a></li>
</ul></li>
<li class="part"><span><b>VI Analysis</b></span></li>
<li class="chapter" data-level="22" data-path="introduction-5.html"><a href="introduction-5.html"><i class="fa fa-check"></i><b>22</b> Introduction</a></li>
<li class="part"><span><b>VII Appendix</b></span></li>
<li class="chapter" data-level="23" data-path="introduction-6.html"><a href="introduction-6.html"><i class="fa fa-check"></i><b>23</b> Introduction</a></li>
<li class="chapter" data-level="24" data-path="additional-reading.html"><a href="additional-reading.html"><i class="fa fa-check"></i><b>24</b> Additional Reading</a><ul>
<li class="chapter" data-level="24.1" data-path="additional-reading.html"><a href="additional-reading.html#books"><i class="fa fa-check"></i><b>24.1</b> Books</a></li>
<li class="chapter" data-level="24.2" data-path="additional-reading.html"><a href="additional-reading.html#papers"><i class="fa fa-check"></i><b>24.2</b> Papers</a></li>
<li class="chapter" data-level="24.3" data-path="additional-reading.html"><a href="additional-reading.html#blog-posts"><i class="fa fa-check"></i><b>24.3</b> Blog Posts</a></li>
<li class="chapter" data-level="24.4" data-path="additional-reading.html"><a href="additional-reading.html#miscellaneous"><i class="fa fa-check"></i><b>24.4</b> Miscellaneous</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="class-imbalance.html"><a href="class-imbalance.html"><i class="fa fa-check"></i><b>25</b> Class Imbalance</a></li>
<li class="chapter" data-level="26" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>26</b> Missing Data</a></li>
<li class="chapter" data-level="27" data-path="three-weird-tricks.html"><a href="three-weird-tricks.html"><i class="fa fa-check"></i><b>27</b> Three Weird Tricks</a><ul>
<li class="chapter" data-level="27.1" data-path="three-weird-tricks.html"><a href="three-weird-tricks.html#why-estimate-just-the-mean"><i class="fa fa-check"></i><b>27.1</b> Why Estimate Just The Mean?</a></li>
<li class="chapter" data-level="27.2" data-path="three-weird-tricks.html"><a href="three-weird-tricks.html#predict-i-dont-know"><i class="fa fa-check"></i><b>27.2</b> Predict “I Don’t Know!”</a></li>
<li class="chapter" data-level="27.3" data-path="three-weird-tricks.html"><a href="three-weird-tricks.html#predict-that-you-shouldnt-predict"><i class="fa fa-check"></i><b>27.3</b> Predict That You Shouldn’t Predict</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daviddalpiaz/bsl" target="blank">&copy; 2019 David Dalpiaz</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Basics of Statistical Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regularization" class="section level1">
<h1><span class="header-section-number">Chapter 14</span> Regularization</h1>
<hr />
<div id="stat-432-materials-2" class="section level2">
<h2><span class="header-section-number">14.1</span> STAT 432 Materials</h2>
<ul>
<li>ISL Readings: Sections 6.1 - 6.4</li>
</ul>
<hr />
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</a>
<a class="sourceLine" id="cb145-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;glmnet&quot;</span>)</a>
<a class="sourceLine" id="cb145-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)</a>
<a class="sourceLine" id="cb145-4" data-line-number="4"><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>)</a></code></pre></div>
</div>
<div id="reducing-variance-with-added-bias" class="section level2">
<h2><span class="header-section-number">14.2</span> Reducing Variance with Added Bias</h2>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1">gen_simple_data =<span class="st"> </span><span class="cf">function</span>(<span class="dt">sample_size =</span> <span class="dv">25</span>) {</a>
<a class="sourceLine" id="cb146-2" data-line-number="2">  x =<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> sample_size)</a>
<a class="sourceLine" id="cb146-3" data-line-number="3">  y =<span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> sample_size)</a>
<a class="sourceLine" id="cb146-4" data-line-number="4">  <span class="kw">data.frame</span>(x, y)</a>
<a class="sourceLine" id="cb146-5" data-line-number="5">}</a></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb147-2" data-line-number="2">simple_data =<span class="st"> </span><span class="kw">gen_simple_data</span>()</a></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="co"># fit least squares</span></a>
<a class="sourceLine" id="cb148-2" data-line-number="2">beta_ls =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>x, <span class="dt">data =</span> simple_data)</a>
<a class="sourceLine" id="cb148-3" data-line-number="3"></a>
<a class="sourceLine" id="cb148-4" data-line-number="4"><span class="co"># fit a biased model</span></a>
<a class="sourceLine" id="cb148-5" data-line-number="5"><span class="co"># restrict beta-hat to be at most 5</span></a>
<a class="sourceLine" id="cb148-6" data-line-number="6">beta_<span class="dv">05</span> =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>x, <span class="dt">data =</span> simple_data)</a>
<a class="sourceLine" id="cb148-7" data-line-number="7">beta_<span class="dv">05</span><span class="op">$</span>coefficients =<span class="st"> </span><span class="kw">min</span>(beta_<span class="dv">05</span><span class="op">$</span>coefficients, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb148-8" data-line-number="8"></a>
<a class="sourceLine" id="cb148-9" data-line-number="9"><span class="co"># fit a biased model</span></a>
<a class="sourceLine" id="cb148-10" data-line-number="10"><span class="co"># restrict beta-hat to be at most 4</span></a>
<a class="sourceLine" id="cb148-11" data-line-number="11">beta_<span class="dv">04</span> =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>x, <span class="dt">data =</span> simple_data)</a>
<a class="sourceLine" id="cb148-12" data-line-number="12">beta_<span class="dv">04</span><span class="op">$</span>coefficients =<span class="st"> </span><span class="kw">min</span>(beta_<span class="dv">04</span><span class="op">$</span>coefficients, <span class="dv">4</span>)</a></code></pre></div>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1"><span class="kw">map_dbl</span>(<span class="kw">list</span>(beta_ls, beta_<span class="dv">05</span>, beta_<span class="dv">04</span>), coef)</a></code></pre></div>
<pre><code>## [1] 5.325953 5.000000 4.000000</code></pre>
<p><img src="03-07-regularization_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1"><span class="co"># maybe write a function for each</span></a>
<a class="sourceLine" id="cb151-2" data-line-number="2"><span class="co"># should switch this to make each model fit to the same data</span></a>
<a class="sourceLine" id="cb151-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb151-4" data-line-number="4">beta_estimates =<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb151-5" data-line-number="5">  <span class="dt">beta_ls =</span> <span class="kw">replicate</span>(<span class="dt">n =</span> <span class="dv">5000</span>, <span class="kw">coef</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>x, <span class="dt">data =</span> <span class="kw">gen_simple_data</span>()))[<span class="st">&quot;x&quot;</span>]),</a>
<a class="sourceLine" id="cb151-6" data-line-number="6">  <span class="dt">beta_05 =</span> <span class="kw">replicate</span>(<span class="dt">n =</span> <span class="dv">5000</span>, <span class="kw">min</span>(<span class="kw">coef</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>x, <span class="dt">data =</span> <span class="kw">gen_simple_data</span>()))[<span class="st">&quot;x&quot;</span>], <span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb151-7" data-line-number="7">  <span class="dt">beta_04 =</span> <span class="kw">replicate</span>(<span class="dt">n =</span> <span class="dv">5000</span>, <span class="kw">min</span>(<span class="kw">coef</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>x, <span class="dt">data =</span> <span class="kw">gen_simple_data</span>()))[<span class="st">&quot;x&quot;</span>], <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb151-8" data-line-number="8">)</a></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:right;">
Bias
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
MSE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Least Squares
</td>
<td style="text-align:right;">
-0.003
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.130
</td>
</tr>
<tr>
<td style="text-align:left;">
Biased to 5
</td>
<td style="text-align:right;">
-0.134
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Biased to 4
</td>
<td style="text-align:right;">
-1.000
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
1.001
</td>
</tr>
</tbody>
</table>
</div>
<div id="scaling-matters" class="section level2">
<h2><span class="header-section-number">14.3</span> scaling matters?</h2>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1">another_dgp =<span class="st"> </span><span class="cf">function</span>(<span class="dt">sample_size =</span> <span class="dv">25</span>) {</a>
<a class="sourceLine" id="cb152-2" data-line-number="2">  x =<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> sample_size)</a>
<a class="sourceLine" id="cb152-3" data-line-number="3">  y =<span class="st"> </span><span class="dv">-2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> sample_size)</a>
<a class="sourceLine" id="cb152-4" data-line-number="4">  <span class="kw">tibble</span>(x, y)</a>
<a class="sourceLine" id="cb152-5" data-line-number="5">}</a></code></pre></div>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1">data_for_scaling =<span class="st"> </span><span class="kw">another_dgp</span>()</a>
<a class="sourceLine" id="cb153-2" data-line-number="2"><span class="kw">predict</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> data_for_scaling))</a></code></pre></div>
<pre><code>##          1          2          3          4          5          6          7 
## -1.3821582 -1.9123198  2.3840155 -1.9167476  2.6436459 -0.0673255 -0.2236885 
##          8          9         10         11         12         13         14 
##  2.4778373  1.1021074  1.6899061  0.2489363 -0.7390997  3.4760505  0.4906860 
##         15         16         17         18         19         20         21 
## -0.9683105  0.4202554  1.7825769 -0.2720839  0.9580110  1.1225404  2.9943423 
##         22         23         24         25 
##  3.7554539  1.2570305 -0.9414314  2.3061219</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1"><span class="kw">coef</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> data_for_scaling))</a></code></pre></div>
<pre><code>## (Intercept)           x 
##   -2.229674    6.287082</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1">data_for_scaling<span class="op">$</span>x =<span class="st"> </span><span class="kw">scale</span>(data_for_scaling<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb157-2" data-line-number="2"><span class="kw">predict</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> data_for_scaling))</a></code></pre></div>
<pre><code>##          1          2          3          4          5          6          7 
## -1.3821582 -1.9123198  2.3840155 -1.9167476  2.6436459 -0.0673255 -0.2236885 
##          8          9         10         11         12         13         14 
##  2.4778373  1.1021074  1.6899061  0.2489363 -0.7390997  3.4760505  0.4906860 
##         15         16         17         18         19         20         21 
## -0.9683105  0.4202554  1.7825769 -0.2720839  0.9580110  1.1225404  2.9943423 
##         22         23         24         25 
##  3.7554539  1.2570305 -0.9414314  2.3061219</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1"><span class="kw">coef</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> data_for_scaling))</a></code></pre></div>
<pre><code>## (Intercept)           x 
##   0.8274541   1.6506452</code></pre>
</div>
<div id="constraints-in-two-dimensions" class="section level2">
<h2><span class="header-section-number">14.4</span> Constraints in Two Dimensions</h2>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1">gen_linear_data =<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb161-2" data-line-number="2">  x1 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb161-3" data-line-number="3">  x2 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb161-4" data-line-number="4">  y =<span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">-5</span> <span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb161-5" data-line-number="5">  <span class="kw">tibble</span>(<span class="dt">x1 =</span> x1, <span class="dt">x2 =</span> x2, <span class="dt">y =</span> y)</a>
<a class="sourceLine" id="cb161-6" data-line-number="6">}</a></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1">data =<span class="st"> </span><span class="kw">gen_linear_data</span>()</a>
<a class="sourceLine" id="cb162-2" data-line-number="2">beta =<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">beta_1 =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb162-3" data-line-number="3">                   <span class="dt">beta_2 =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb162-4" data-line-number="4">beta_error =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">dim</span>(beta)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb162-5" data-line-number="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(beta)[<span class="dv">1</span>]){</a>
<a class="sourceLine" id="cb162-6" data-line-number="6">  beta_error[i] =<span class="st"> </span><span class="kw">with</span>(data, <span class="kw">sum</span>((y <span class="op">-</span><span class="st"> </span>(beta<span class="op">$</span>beta_<span class="dv">1</span>[i] <span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>beta<span class="op">$</span>beta_<span class="dv">2</span>[i] <span class="op">*</span><span class="st"> </span>x2)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> ))</a>
<a class="sourceLine" id="cb162-7" data-line-number="7">}</a></code></pre></div>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="co"># </span><span class="al">TODO</span><span class="co">: make this into a function</span></a>
<a class="sourceLine" id="cb163-2" data-line-number="2"><span class="co"># </span><span class="al">TODO</span><span class="co">: add ridge constraint</span></a>
<a class="sourceLine" id="cb163-3" data-line-number="3"><span class="kw">contour</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.1</span>), </a>
<a class="sourceLine" id="cb163-4" data-line-number="4">        <span class="dt">y =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.1</span>), </a>
<a class="sourceLine" id="cb163-5" data-line-number="5">        <span class="dt">z =</span> <span class="kw">matrix</span>(beta_error, </a>
<a class="sourceLine" id="cb163-6" data-line-number="6">                   <span class="dt">nrow =</span> <span class="kw">length</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.1</span>)),</a>
<a class="sourceLine" id="cb163-7" data-line-number="7">                   <span class="dt">ncol =</span> <span class="kw">length</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.1</span>))),</a>
<a class="sourceLine" id="cb163-8" data-line-number="8">        <span class="dt">nlevels =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb163-9" data-line-number="9">        <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span></a>
<a class="sourceLine" id="cb163-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb163-11" data-line-number="11"></a>
<a class="sourceLine" id="cb163-12" data-line-number="12"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb163-13" data-line-number="13"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb163-14" data-line-number="14">a =<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb163-15" data-line-number="15"><span class="kw">segments</span>(<span class="dv">0</span>, a, a, <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb163-16" data-line-number="16"><span class="kw">segments</span>(<span class="dv">0</span>, <span class="op">-</span>a, a, <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb163-17" data-line-number="17"><span class="kw">segments</span>(<span class="op">-</span>a, <span class="dv">0</span>, <span class="dv">0</span>, a, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb163-18" data-line-number="18"><span class="kw">segments</span>(<span class="op">-</span>a, <span class="dv">0</span>, <span class="dv">0</span>, <span class="op">-</span>a, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb163-19" data-line-number="19"><span class="kw">points</span>(beta[<span class="kw">which.min</span>(beta_error), ], <span class="dt">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">cex =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="03-07-regularization_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="high-dimensional-data" class="section level2">
<h2><span class="header-section-number">14.5</span> High Dimensional Data</h2>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" data-line-number="1">gen_wide_data =<span class="st"> </span><span class="cf">function</span>(<span class="dt">sample_size =</span> <span class="dv">100</span>, <span class="dt">sig_betas =</span> <span class="dv">5</span>, <span class="dt">p =</span> <span class="dv">200</span>) {</a>
<a class="sourceLine" id="cb164-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb164-3" data-line-number="3">  <span class="cf">if</span> (p <span class="op">&lt;=</span><span class="st"> </span>sample_size) {</a>
<a class="sourceLine" id="cb164-4" data-line-number="4">    <span class="kw">warning</span>(<span class="st">&quot;You&#39;re not generating wide data, despite the name of the function.&quot;</span>)</a>
<a class="sourceLine" id="cb164-5" data-line-number="5">  }</a>
<a class="sourceLine" id="cb164-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb164-7" data-line-number="7">  <span class="cf">if</span> (sig_betas <span class="op">&gt;</span><span class="st"> </span>p) {</a>
<a class="sourceLine" id="cb164-8" data-line-number="8">    <span class="kw">stop</span>(<span class="st">&quot;Cannot have more significant variables than variables!&quot;</span>)</a>
<a class="sourceLine" id="cb164-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb164-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb164-11" data-line-number="11">  x =<span class="st"> </span><span class="kw">map_dfc</span>(<span class="dv">1</span><span class="op">:</span>p, <span class="op">~</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> sample_size))</a>
<a class="sourceLine" id="cb164-12" data-line-number="12">  x =<span class="st"> </span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename_all</span>( <span class="op">~</span><span class="st"> </span><span class="kw">str_replace</span>(., <span class="st">&quot;V&quot;</span>, <span class="st">&quot;x&quot;</span>))</a>
<a class="sourceLine" id="cb164-13" data-line-number="13">  sig_x =<span class="st"> </span>x[, <span class="dv">1</span><span class="op">:</span>sig_betas]</a>
<a class="sourceLine" id="cb164-14" data-line-number="14">  beta =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">3</span>, <span class="dt">times =</span> sig_betas)</a>
<a class="sourceLine" id="cb164-15" data-line-number="15">  y =<span class="st"> </span><span class="kw">as.matrix</span>(sig_x) <span class="op">%*%</span><span class="st"> </span>beta <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> sample_size)</a>
<a class="sourceLine" id="cb164-16" data-line-number="16">  <span class="kw">bind_cols</span>(<span class="dt">y =</span> y, x)</a>
<a class="sourceLine" id="cb164-17" data-line-number="17">}</a></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" data-line-number="1">some_wide_data =<span class="st"> </span><span class="kw">gen_wide_data</span>()</a></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" data-line-number="1">some_wide_data</a></code></pre></div>
<pre><code>## # A tibble: 100 x 201
##      y[,1]     x1     x2      x3       x4      x5      x6     x7     x8     x9
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1  5.00    1.75  -0.449  1.09   -0.981    0.217  -0.390   1.13   1.83  -0.989
##  2 -7.81   -0.792 -0.659 -0.823  -0.275    0.281   0.931   0.680  0.354  0.628
##  3  4.29    0.648  0.533 -0.415   1.19    -0.451   0.914   0.953  0.527  0.529
##  4  7.22    1.06   0.913  0.0341  0.793   -0.522   0.680  -0.124  1.74   0.955
##  5 -2.09   -0.603 -0.594 -0.141   0.897    0.162  -0.0729 -0.550  2.81   1.71 
##  6 -6.24    0.461 -0.996 -1.25   -0.386   -0.175  -0.153  -0.914  0.230  0.624
##  7 10.2     1.45   1.60   0.426   0.0269   0.318   0.0255 -2.15   0.669 -0.178
##  8  2.42    0.576  0.757  0.537  -0.828   -0.348  -0.640   2.25   0.942  1.10 
##  9 -0.0202 -0.287  0.276 -0.550   0.537   -0.0493  1.42   -0.558 -0.283  0.489
## 10  1.49    0.563 -0.264  0.0107  0.00393 -0.367   1.75   -0.893  1.75   1.08 
## # … with 90 more rows, and 191 more variables: x10 &lt;dbl&gt;, x11 &lt;dbl&gt;, x12 &lt;dbl&gt;,
## #   x13 &lt;dbl&gt;, x14 &lt;dbl&gt;, x15 &lt;dbl&gt;, x16 &lt;dbl&gt;, x17 &lt;dbl&gt;, x18 &lt;dbl&gt;,
## #   x19 &lt;dbl&gt;, x20 &lt;dbl&gt;, x21 &lt;dbl&gt;, x22 &lt;dbl&gt;, x23 &lt;dbl&gt;, x24 &lt;dbl&gt;,
## #   x25 &lt;dbl&gt;, x26 &lt;dbl&gt;, x27 &lt;dbl&gt;, x28 &lt;dbl&gt;, x29 &lt;dbl&gt;, x30 &lt;dbl&gt;,
## #   x31 &lt;dbl&gt;, x32 &lt;dbl&gt;, x33 &lt;dbl&gt;, x34 &lt;dbl&gt;, x35 &lt;dbl&gt;, x36 &lt;dbl&gt;,
## #   x37 &lt;dbl&gt;, x38 &lt;dbl&gt;, x39 &lt;dbl&gt;, x40 &lt;dbl&gt;, x41 &lt;dbl&gt;, x42 &lt;dbl&gt;,
## #   x43 &lt;dbl&gt;, x44 &lt;dbl&gt;, x45 &lt;dbl&gt;, x46 &lt;dbl&gt;, x47 &lt;dbl&gt;, x48 &lt;dbl&gt;,
## #   x49 &lt;dbl&gt;, x50 &lt;dbl&gt;, x51 &lt;dbl&gt;, x52 &lt;dbl&gt;, x53 &lt;dbl&gt;, x54 &lt;dbl&gt;,
## #   x55 &lt;dbl&gt;, x56 &lt;dbl&gt;, x57 &lt;dbl&gt;, x58 &lt;dbl&gt;, x59 &lt;dbl&gt;, x60 &lt;dbl&gt;,
## #   x61 &lt;dbl&gt;, x62 &lt;dbl&gt;, x63 &lt;dbl&gt;, x64 &lt;dbl&gt;, x65 &lt;dbl&gt;, x66 &lt;dbl&gt;,
## #   x67 &lt;dbl&gt;, x68 &lt;dbl&gt;, x69 &lt;dbl&gt;, x70 &lt;dbl&gt;, x71 &lt;dbl&gt;, x72 &lt;dbl&gt;,
## #   x73 &lt;dbl&gt;, x74 &lt;dbl&gt;, x75 &lt;dbl&gt;, x76 &lt;dbl&gt;, x77 &lt;dbl&gt;, x78 &lt;dbl&gt;,
## #   x79 &lt;dbl&gt;, x80 &lt;dbl&gt;, x81 &lt;dbl&gt;, x82 &lt;dbl&gt;, x83 &lt;dbl&gt;, x84 &lt;dbl&gt;,
## #   x85 &lt;dbl&gt;, x86 &lt;dbl&gt;, x87 &lt;dbl&gt;, x88 &lt;dbl&gt;, x89 &lt;dbl&gt;, x90 &lt;dbl&gt;,
## #   x91 &lt;dbl&gt;, x92 &lt;dbl&gt;, x93 &lt;dbl&gt;, x94 &lt;dbl&gt;, x95 &lt;dbl&gt;, x96 &lt;dbl&gt;,
## #   x97 &lt;dbl&gt;, x98 &lt;dbl&gt;, x99 &lt;dbl&gt;, x100 &lt;dbl&gt;, x101 &lt;dbl&gt;, x102 &lt;dbl&gt;,
## #   x103 &lt;dbl&gt;, x104 &lt;dbl&gt;, x105 &lt;dbl&gt;, x106 &lt;dbl&gt;, x107 &lt;dbl&gt;, x108 &lt;dbl&gt;,
## #   x109 &lt;dbl&gt;, …</code></pre>
</div>
<div id="ridge-regression" class="section level2">
<h2><span class="header-section-number">14.6</span> Ridge Regression</h2>
<p><span class="math display">\[
\sum_{i=1}^{n} \left( y_i - \beta_0 - \sum_{j=1}^{p} \beta_j x_{ij}    \right) ^ 2 + \lambda \sum_{j=1}^{p} \beta_j^2 .
\]</span></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb168-2" data-line-number="2">data_for_ridge =<span class="st"> </span><span class="kw">gen_wide_data</span>(<span class="dt">sample_size =</span> <span class="dv">100</span>, <span class="dt">sig_betas =</span> <span class="dv">5</span>, <span class="dt">p =</span> <span class="dv">200</span>)</a></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" data-line-number="1">x_ridge =<span class="st"> </span>data_for_ridge <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>y) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>()</a>
<a class="sourceLine" id="cb169-2" data-line-number="2">y_ridge =<span class="st"> </span>data_for_ridge <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(y)</a></code></pre></div>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" data-line-number="1">mod_ridge =<span class="st"> </span><span class="kw">glmnet</span>(<span class="dt">x =</span> x_ridge, <span class="dt">y =</span> y_ridge, <span class="dt">alpha =</span> <span class="dv">0</span>)</a></code></pre></div>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" data-line-number="1"><span class="kw">plot</span>(mod_ridge, <span class="dt">xvar =</span> <span class="st">&quot;lambda&quot;</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb171-2" data-line-number="2"><span class="kw">grid</span>()</a></code></pre></div>
<p><img src="03-07-regularization_files/figure-html/unnamed-chunk-20-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" data-line-number="1"><span class="kw">as_tibble</span>(<span class="kw">predict</span>(mod_ridge, x_ridge[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, ]))</a></code></pre></div>
<pre><code>## # A tibble: 5 x 100
##       s0     s1     s2     s3     s4     s5     s6     s7     s8     s9    s10
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 -0.407 -0.357 -0.354 -0.352 -0.349 -0.346 -0.344 -0.341 -0.337 -0.334 -0.331
## 2 -0.407 -0.400 -0.400 -0.400 -0.399 -0.399 -0.398 -0.398 -0.398 -0.397 -0.397
## 3 -0.407 -0.361 -0.359 -0.356 -0.354 -0.352 -0.349 -0.346 -0.343 -0.340 -0.337
## 4 -0.407 -0.322 -0.318 -0.314 -0.310 -0.305 -0.301 -0.295 -0.290 -0.285 -0.279
## 5 -0.407 -0.441 -0.442 -0.444 -0.446 -0.447 -0.449 -0.451 -0.453 -0.456 -0.458
## # … with 89 more variables: s11 &lt;dbl&gt;, s12 &lt;dbl&gt;, s13 &lt;dbl&gt;, s14 &lt;dbl&gt;,
## #   s15 &lt;dbl&gt;, s16 &lt;dbl&gt;, s17 &lt;dbl&gt;, s18 &lt;dbl&gt;, s19 &lt;dbl&gt;, s20 &lt;dbl&gt;,
## #   s21 &lt;dbl&gt;, s22 &lt;dbl&gt;, s23 &lt;dbl&gt;, s24 &lt;dbl&gt;, s25 &lt;dbl&gt;, s26 &lt;dbl&gt;,
## #   s27 &lt;dbl&gt;, s28 &lt;dbl&gt;, s29 &lt;dbl&gt;, s30 &lt;dbl&gt;, s31 &lt;dbl&gt;, s32 &lt;dbl&gt;,
## #   s33 &lt;dbl&gt;, s34 &lt;dbl&gt;, s35 &lt;dbl&gt;, s36 &lt;dbl&gt;, s37 &lt;dbl&gt;, s38 &lt;dbl&gt;,
## #   s39 &lt;dbl&gt;, s40 &lt;dbl&gt;, s41 &lt;dbl&gt;, s42 &lt;dbl&gt;, s43 &lt;dbl&gt;, s44 &lt;dbl&gt;,
## #   s45 &lt;dbl&gt;, s46 &lt;dbl&gt;, s47 &lt;dbl&gt;, s48 &lt;dbl&gt;, s49 &lt;dbl&gt;, s50 &lt;dbl&gt;,
## #   s51 &lt;dbl&gt;, s52 &lt;dbl&gt;, s53 &lt;dbl&gt;, s54 &lt;dbl&gt;, s55 &lt;dbl&gt;, s56 &lt;dbl&gt;,
## #   s57 &lt;dbl&gt;, s58 &lt;dbl&gt;, s59 &lt;dbl&gt;, s60 &lt;dbl&gt;, s61 &lt;dbl&gt;, s62 &lt;dbl&gt;,
## #   s63 &lt;dbl&gt;, s64 &lt;dbl&gt;, s65 &lt;dbl&gt;, s66 &lt;dbl&gt;, s67 &lt;dbl&gt;, s68 &lt;dbl&gt;,
## #   s69 &lt;dbl&gt;, s70 &lt;dbl&gt;, s71 &lt;dbl&gt;, s72 &lt;dbl&gt;, s73 &lt;dbl&gt;, s74 &lt;dbl&gt;,
## #   s75 &lt;dbl&gt;, s76 &lt;dbl&gt;, s77 &lt;dbl&gt;, s78 &lt;dbl&gt;, s79 &lt;dbl&gt;, s80 &lt;dbl&gt;,
## #   s81 &lt;dbl&gt;, s82 &lt;dbl&gt;, s83 &lt;dbl&gt;, s84 &lt;dbl&gt;, s85 &lt;dbl&gt;, s86 &lt;dbl&gt;,
## #   s87 &lt;dbl&gt;, s88 &lt;dbl&gt;, s89 &lt;dbl&gt;, s90 &lt;dbl&gt;, s91 &lt;dbl&gt;, s92 &lt;dbl&gt;,
## #   s93 &lt;dbl&gt;, s94 &lt;dbl&gt;, s95 &lt;dbl&gt;, s96 &lt;dbl&gt;, s97 &lt;dbl&gt;, s98 &lt;dbl&gt;, s99 &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb174-2" data-line-number="2">mod_ridge =<span class="st"> </span><span class="kw">cv.glmnet</span>(<span class="dt">x =</span> x_ridge, <span class="dt">y =</span> y_ridge, <span class="dt">alpha =</span> <span class="dv">0</span>, <span class="dt">nfolds =</span> <span class="dv">5</span>)</a></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" data-line-number="1"><span class="kw">glance</span>(mod_ridge)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   lambda.min lambda.1se
##        &lt;dbl&gt;      &lt;dbl&gt;
## 1       35.4       67.9</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" data-line-number="1"><span class="kw">plot</span>(mod_ridge)</a></code></pre></div>
<p><img src="03-07-regularization_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" data-line-number="1"><span class="kw">tidy</span>(mod_ridge)</a></code></pre></div>
<pre><code>## # A tibble: 100 x 6
##    lambda estimate std.error conf.low conf.high nzero
##     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;
##  1  3543.     45.1      4.01     41.1      49.1   200
##  2  3382.     45.1      4.02     41.1      49.1   200
##  3  3228.     45.1      4.01     41.1      49.1   200
##  4  3081.     45.0      3.99     41.0      49.0   200
##  5  2941.     45.0      3.96     41.0      48.9   200
##  6  2808.     45.0      3.96     41.0      48.9   200
##  7  2680.     45.0      3.95     41.0      48.9   200
##  8  2558.     44.9      3.95     41.0      48.9   200
##  9  2442.     44.9      3.95     41.0      48.9   200
## 10  2331.     44.9      3.95     41.0      48.9   200
## # … with 90 more rows</code></pre>
</div>
<div id="lasso" class="section level2">
<h2><span class="header-section-number">14.7</span> Lasso</h2>
</div>
<div id="boston-is-boring" class="section level2">
<h2><span class="header-section-number">14.8</span> boston is boring</h2>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" data-line-number="1">bstn =<span class="st"> </span>MASS<span class="op">::</span>Boston</a>
<a class="sourceLine" id="cb180-2" data-line-number="2"></a>
<a class="sourceLine" id="cb180-3" data-line-number="3">bstn<span class="op">$</span>chas =<span class="st"> </span><span class="kw">factor</span>(bstn<span class="op">$</span>chas)</a>
<a class="sourceLine" id="cb180-4" data-line-number="4">bstn<span class="op">$</span>rad =<span class="st"> </span><span class="kw">factor</span>(bstn<span class="op">$</span>rad)</a>
<a class="sourceLine" id="cb180-5" data-line-number="5"></a>
<a class="sourceLine" id="cb180-6" data-line-number="6"><span class="kw">levels</span>(bstn<span class="op">$</span>chas)</a></code></pre></div>
<pre><code>## [1] &quot;0&quot; &quot;1&quot;</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" data-line-number="1"><span class="kw">levels</span>(bstn<span class="op">$</span>rad)</a></code></pre></div>
<pre><code>## [1] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;24&quot;</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" data-line-number="1"><span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> bstn)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ ., data = bstn)
## 
## Coefficients:
## (Intercept)         crim           zn        indus        chas1          nox  
##   35.259615    -0.108821     0.054896     0.023760     2.524163   -17.573132  
##          rm          age          dis         rad2         rad3         rad4  
##    3.665491     0.000461    -1.554546     1.488905     4.681253     2.576234  
##        rad5         rad6         rad7         rad8        rad24          tax  
##    2.918493     1.185839     4.878992     4.839836     7.461674    -0.008748  
##     ptratio        black        lstat  
##   -0.972419     0.009394    -0.529226</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" data-line-number="1"><span class="kw">head</span>(<span class="kw">as_tibble</span>(<span class="kw">model.matrix</span>(<span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> bstn))))</a></code></pre></div>
<pre><code>## # A tibble: 6 x 21
##   `(Intercept)`    crim    zn indus chas1   nox    rm   age   dis  rad2  rad3
##           &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1             1 0.00632    18  2.31     0 0.538  6.58  65.2  4.09     0     0
## 2             1 0.0273      0  7.07     0 0.469  6.42  78.9  4.97     1     0
## 3             1 0.0273      0  7.07     0 0.469  7.18  61.1  4.97     1     0
## 4             1 0.0324      0  2.18     0 0.458  7.00  45.8  6.06     0     1
## 5             1 0.0690      0  2.18     0 0.458  7.15  54.2  6.06     0     1
## 6             1 0.0298      0  2.18     0 0.458  6.43  58.7  6.06     0     1
## # … with 10 more variables: rad4 &lt;dbl&gt;, rad5 &lt;dbl&gt;, rad6 &lt;dbl&gt;, rad7 &lt;dbl&gt;,
## #   rad8 &lt;dbl&gt;, rad24 &lt;dbl&gt;, tax &lt;dbl&gt;, ptratio &lt;dbl&gt;, black &lt;dbl&gt;, lstat &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1">bstn_x =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> bstn))</a>
<a class="sourceLine" id="cb188-2" data-line-number="2">bstn_y =<span class="st"> </span>bstn<span class="op">$</span>medv</a></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1"><span class="kw">coef</span>(<span class="kw">lm.fit</span>(<span class="dt">x =</span> bstn_x, <span class="dt">y =</span> bstn_y))</a></code></pre></div>
<pre><code>##   (Intercept)          crim            zn         indus         chas1 
##  3.525962e+01 -1.088210e-01  5.489638e-02  2.376030e-02  2.524163e+00 
##           nox            rm           age           dis          rad2 
## -1.757313e+01  3.665491e+00  4.610055e-04 -1.554546e+00  1.488905e+00 
##          rad3          rad4          rad5          rad6          rad7 
##  4.681253e+00  2.576234e+00  2.918493e+00  1.185839e+00  4.878992e+00 
##          rad8         rad24           tax       ptratio         black 
##  4.839836e+00  7.461674e+00 -8.748175e-03 -9.724194e-01  9.393803e-03 
##         lstat 
## -5.292258e-01</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1">bstn_x =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> bstn))[, <span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb191-2" data-line-number="2">bstn_y =<span class="st"> </span>bstn<span class="op">$</span>medv</a></code></pre></div>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb192-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">glmnet</span>(<span class="dt">x =</span> bstn_x, <span class="dt">y =</span> bstn_y, <span class="dt">alpha =</span> <span class="dv">0</span>), <span class="dt">xvar =</span> <span class="st">&quot;lambda&quot;</span>)</a>
<a class="sourceLine" id="cb192-3" data-line-number="3"><span class="kw">grid</span>()</a>
<a class="sourceLine" id="cb192-4" data-line-number="4"><span class="kw">plot</span>(<span class="kw">glmnet</span>(<span class="dt">x =</span> bstn_x, <span class="dt">y =</span> bstn_y, <span class="dt">alpha =</span> <span class="dv">1</span>), <span class="dt">xvar =</span> <span class="st">&quot;lambda&quot;</span>)</a>
<a class="sourceLine" id="cb192-5" data-line-number="5"><span class="kw">grid</span>()</a></code></pre></div>
<p><img src="03-07-regularization_files/figure-html/unnamed-chunk-32-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb193-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">cv.glmnet</span>(<span class="dt">x =</span> bstn_x, <span class="dt">y =</span> bstn_y, <span class="dt">alpha =</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb193-3" data-line-number="3"><span class="kw">plot</span>(<span class="kw">cv.glmnet</span>(<span class="dt">x =</span> bstn_x, <span class="dt">y =</span> bstn_y, <span class="dt">alpha =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="03-07-regularization_files/figure-html/unnamed-chunk-33-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1">bstn_ridge =<span class="st"> </span><span class="kw">cv.glmnet</span>(<span class="dt">x =</span> bstn_x, <span class="dt">y =</span> bstn_y, <span class="dt">alpha =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb194-2" data-line-number="2">bstn_lasso =<span class="st"> </span><span class="kw">cv.glmnet</span>(<span class="dt">x =</span> bstn_x, <span class="dt">y =</span> bstn_y, <span class="dt">alpha =</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1"><span class="kw">tidy</span>(bstn_lasso)</a></code></pre></div>
<pre><code>## # A tibble: 83 x 6
##    lambda estimate std.error conf.low conf.high nzero
##     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;
##  1   6.78     84.3      8.10     76.2      92.4     0
##  2   6.18     77.2      7.94     69.2      85.1     1
##  3   5.63     70.4      7.51     62.9      77.9     2
##  4   5.13     64.0      7.06     57.0      71.1     2
##  5   4.67     58.5      6.59     51.9      65.0     2
##  6   4.26     53.8      6.17     47.6      60.0     2
##  7   3.88     49.9      5.82     44.1      55.8     2
##  8   3.53     46.7      5.53     41.2      52.3     2
##  9   3.22     44.1      5.28     38.8      49.3     2
## 10   2.93     41.6      5.08     36.5      46.7     3
## # … with 73 more rows</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1"><span class="kw">glance</span>(bstn_lasso)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   lambda.min lambda.1se
##        &lt;dbl&gt;      &lt;dbl&gt;
## 1    0.00694      0.315</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" data-line-number="1"><span class="co"># </span><span class="al">TODO</span><span class="co">: pull out rows of tidy with the values from glance</span></a></code></pre></div>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1"><span class="kw">predict</span>(bstn_lasso, <span class="dt">newx =</span> bstn_x[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,], <span class="dt">type =</span> <span class="st">&quot;link&quot;</span>)</a></code></pre></div>
<pre><code>##           1
## 1  30.39658
## 2  25.38272
## 3  31.23894
## 4  31.17211
## 5  30.57321
## 6  27.58938
## 7  23.54446
## 8  20.54428
## 9  12.51911
## 10 20.51929</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1"><span class="kw">predict</span>(bstn_lasso, <span class="dt">newx =</span> bstn_x[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,], <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>##           1
## 1  30.39658
## 2  25.38272
## 3  31.23894
## 4  31.17211
## 5  30.57321
## 6  27.58938
## 7  23.54446
## 8  20.54428
## 9  12.51911
## 10 20.51929</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1"><span class="kw">predict</span>(bstn_lasso, <span class="dt">type =</span> <span class="st">&quot;coefficients&quot;</span>, <span class="dt">s=</span><span class="kw">c</span>(<span class="st">&quot;lambda.1se&quot;</span>,<span class="st">&quot;lambda.min&quot;</span>))</a></code></pre></div>
<pre><code>## 21 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                        1
## (Intercept) 19.386070871
## crim        -0.027179560
## zn           0.004205338
## indus        .          
## chas1        2.033274012
## nox         -4.744669654
## rm           4.223773143
## age          .          
## dis         -0.485529479
## rad2         .          
## rad3         1.353021994
## rad4         .          
## rad5         .          
## rad6        -0.286318856
## rad7         .          
## rad8         0.336943107
## rad24        .          
## tax          .          
## ptratio     -0.810303776
## black        0.006775041
## lstat       -0.519927242</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1"><span class="kw">predict</span>(bstn_lasso, <span class="dt">type =</span> <span class="st">&quot;nonzero&quot;</span>)</a></code></pre></div>
<pre><code>##    X1
## 1   1
## 2   2
## 3   4
## 4   5
## 5   6
## 6   8
## 7  10
## 8  13
## 9  15
## 10 18
## 11 19
## 12 20</code></pre>
</div>
<div id="some-more-simulation" class="section level2">
<h2><span class="header-section-number">14.9</span> some more simulation</h2>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1"><span class="co"># diag(100)</span></a></code></pre></div>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1">p =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb210-2" data-line-number="2">A =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(p <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">ncol =</span> p)</a>
<a class="sourceLine" id="cb210-3" data-line-number="3">Sigma =<span class="st"> </span><span class="kw">t</span>(A) <span class="op">%*%</span><span class="st"> </span>A</a>
<a class="sourceLine" id="cb210-4" data-line-number="4">sample_size =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb210-5" data-line-number="5">X =<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> sample_size, <span class="dt">mu =</span> <span class="kw">rep</span>(<span class="dv">0</span>, p), <span class="dt">Sigma =</span> Sigma)</a>
<a class="sourceLine" id="cb210-6" data-line-number="6">beta =<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">size =</span> p, <span class="dt">replace =</span> <span class="ot">TRUE</span>), <span class="kw">runif</span>(<span class="dt">n =</span> p, <span class="dv">-1</span>, <span class="dv">1</span>), <span class="dv">0</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb210-7" data-line-number="7">y =<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> sample_size, <span class="dt">sd =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb210-8" data-line-number="8">fit =<span class="st"> </span>glmnet<span class="op">::</span><span class="kw">cv.glmnet</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> y, <span class="dt">alpha =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb210-9" data-line-number="9"><span class="kw">sqrt</span>(<span class="kw">min</span>(fit<span class="op">$</span>cvm))</a></code></pre></div>
<pre><code>## [1] 4.086107</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1"><span class="kw">plot</span>(fit, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">20</span>))</a></code></pre></div>
<p><img src="03-07-regularization_files/figure-html/unnamed-chunk-43-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" data-line-number="1"><span class="co"># type.measure = &quot;class&quot;</span></a></code></pre></div>
<ul>
<li>TODO: Least Absolute Shrinkage and Selection Operator</li>
<li>TODO: <a href="https://statisticaloddsandends.wordpress.com/2018/11/15/a-deep-dive-into-glmnet-standardize/" class="uri">https://statisticaloddsandends.wordpress.com/2018/11/15/a-deep-dive-into-glmnet-standardize/</a></li>
<li>TODO: <a href="https://www.jaredlander.com/2018/02/using-coefplot-with-glmnet/" class="uri">https://www.jaredlander.com/2018/02/using-coefplot-with-glmnet/</a></li>
<li>TODO: statistical learning with sparsity book</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="supervised-learning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ensembles.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/daviddalpiaz/bsl/edit/master/03-07-regularization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bsl.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
